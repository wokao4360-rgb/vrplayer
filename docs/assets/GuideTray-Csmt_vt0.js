var o=Object.defineProperty;var d=(c,e,t)=>e in c?o(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var n=(c,e,t)=>d(c,typeof e!="symbol"?e+"":e,t);import{r as m,A as u}from"./index-DhGXQL-R.js";import{toProxiedImageUrl as h}from"./externalImage-Cn8sVw7v.js";class C{constructor(e){n(this,"element");n(this,"scrollEl");n(this,"museumId");n(this,"currentSceneId");n(this,"scenes");n(this,"onSceneClick");n(this,"onMoreClick");n(this,"onClose");this.museumId=e.museumId,this.currentSceneId=e.currentSceneId,this.scenes=e.scenes,this.onSceneClick=e.onSceneClick,this.onMoreClick=e.onMoreClick,this.onClose=e.onClose,this.element=document.createElement("div"),this.element.className="vr-guidetray";const t=document.createElement("div");t.className="vr-guidetray-header";const r=document.createElement("button");r.className="vr-btn vr-guidetray-more",r.textContent="更多",r.addEventListener("click",l=>{var s;l.preventDefault(),l.stopPropagation(),(s=this.onMoreClick)==null||s.call(this)});const i=document.createElement("button");i.className="vr-btn vr-guidetray-close",i.textContent="×",i.setAttribute("aria-label","关闭"),i.addEventListener("click",l=>{var s;l.preventDefault(),l.stopPropagation(),(s=this.onClose)==null||s.call(this)}),t.appendChild(r),t.appendChild(i),this.scrollEl=document.createElement("div"),this.scrollEl.className="vr-guidetray-scroll",this.element.appendChild(t),this.element.appendChild(this.scrollEl),this.render()}render(){this.scrollEl.innerHTML="",this.scenes.forEach(t=>{const r=document.createElement("div");r.className="vr-guidetray-item",r.setAttribute("data-scene-id",t.id),t.id===this.currentSceneId&&r.classList.add("is-current");const i=document.createElement("img");i.className="vr-guidetray-item-thumb",i.referrerPolicy="no-referrer",i.crossOrigin="anonymous",i.decoding="async",i.loading="lazy";const l=t.thumb?m(t.thumb,u.THUMB):void 0;l&&(i.src=h(l)),i.alt=t.name;const s=document.createElement("div");s.className="vr-guidetray-item-title",s.textContent=t.name,r.appendChild(i),r.appendChild(s),r.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),this.onSceneClick&&this.onSceneClick(t.id)}),this.scrollEl.appendChild(r)});const e=document.createElement("div");e.className="vr-guidetray-item vr-guidetray-item-more",e.innerHTML=`
      <div class="vr-guidetray-item-thumb vr-guidetray-more-icon">+</div>
      <div class="vr-guidetray-item-title">更多</div>
    `,e.addEventListener("click",t=>{var r;t.preventDefault(),t.stopPropagation(),(r=this.onMoreClick)==null||r.call(this)}),this.scrollEl.appendChild(e)}updateCurrentScene(e){this.currentSceneId=e,this.scrollEl.querySelectorAll(".vr-guidetray-item").forEach(t=>{const r=t;r.getAttribute("data-scene-id")===e?r.classList.add("is-current"):r.classList.remove("is-current")})}setVisible(e){this.element.classList.toggle("visible",e)}getElement(){return this.element}remove(){this.element.remove()}}export{C as GuideTray};
